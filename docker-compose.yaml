name: thatdamtoolbox

include:
  # Infra-grade services
  - path: ./docker/compose/docker-compose.postgres.yaml
  - path: ./docker/compose/docker-compose.weaviate.yaml
  - path: ./docker/compose/docker-compose.minio.yaml
  - path: ./docker/compose/docker-compose.rabbitmq.yaml
  # Auth stacks (pick with profiles)
  - path: ./docker/compose/auth-auth0.yaml
  - path: ./docker/compose/auth-keycloak.yaml
  # Host/Golang services
  - path: ./host/services/discovery/docker-compose.discovery.yaml
  - path: ./docker/compose/docker-compose.gateway.yaml
  - path: ./docker/compose/docker-compose.api-gateway.yaml
  - path: ./docker/compose/docker-compose.overlay-hub.yaml
  - path: ./docker/compose/docker-compose.capture-daemon.yaml
  - path: ./docker/compose/docker-compose.camera-proxy.yaml
  - path: ./docker/compose/docker-compose.supervisor.yaml
  - path: ./docker/compose/docker-compose.runner.yaml
  - path: ./docker/compose/docker-compose.media-api.yaml
  - path: ./docker/compose/docker-compose.video-api.yaml
  - path: ./docker/compose/docker-compose.video-web.yaml
  - path: ./docker/compose/docker-compose.web-site.yaml
  # Optionals
  - path: ./docker/compose/docker-compose.hotspot-installer.yaml
  - path: ./docker/compose/v2-canary/docker-compose.canary.yaml

networks:
  damnet:
    driver: bridge

secrets:
  dam_ephemeral_token:
    external: false
    environment: "DUMMY_TOKEN"

volumes:
  db_wal:
    driver: local
  rabbitmq_data:
    driver: local
    driver_opts:
      type: none
      o: bind
      device: ${RABBITMQ_DATA_PATH:-./docker/rabbitmq/data}
  discovery-run:
    name: ${COMPOSE_PROJECT_NAME:-thatdamtoolbox}_discovery-run
  video-web-node_modules:
    driver: local
  video-web-next:
    driver: local
  video-web-npm:
    driver: local
  web-site-node_modules:
    driver: local
  web-site-next:
    driver: local
  web-site-npm:
    driver: local
