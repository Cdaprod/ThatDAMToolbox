########################################################################
# Root "/docker-compose.yaml"
########################################################################
name: thatdamtoolbox

# Set IMAGE_TAG to control cdaprod image tags (default: dev)

########################################################################
# Optionally Included Infra-Grade Services
########################################################################
include:
    #### Infra Provided Services
  - path: ./docker/compose/docker-compose.postgres.yaml
  - path: ./docker/compose/docker-compose.weaviate.yaml
  - path: ./docker/compose/docker-compose.minio.yaml
    #### Golang Host Services
  - path: ./host/services/discovery/docker-compose.discovery.yaml
  - path: ./docker/compose/docker-compose.auth-bridge.yaml
  - path: ./docker/compose/docker-compose.keycloak.yaml
  - path: ./docker/compose/docker-compose.hotspot-installer.yaml
  - path: ./docker/compose/docker-compose.gateway.yaml
  - path: ./docker/compose/docker-compose.rabbitmq.yaml
  - path: ./docker/compose/docker-compose.capture-daemon.yaml
  - path: ./docker/compose/docker-compose.camera-proxy.yaml
  - path: ./docker/compose/docker-compose.overlay-hub.yaml
  - path: ./docker/compose/docker-compose.supervisor.yaml
  - path: ./docker/compose/docker-compose.runner.yaml
  - path: ./docker/compose/docker-compose.api-gateway.yaml
  - path: ./docker/compose/docker-compose.media-api.yaml
  - path: ./docker/compose/docker-compose.video-api.yaml
  - path: ./docker/compose/docker-compose.video-cli.yaml
  - path: ./docker/compose/docker-compose.video-web.yaml
  - path: ./docker/compose/docker-compose.web-site.yaml

########################################################################
# Network Bridge "damnet"
########################################################################
networks:
  damnet:
    driver: bridge

########################################################################
# (Optional) hotspot-installer secrets
########################################################################
secrets:
  dam_ephemeral_token:
    external: false
    # Dummy content when not actually needed
    environment: "DUMMY_TOKEN"

########################################################################
# container mounted volumes
########################################################################
volumes:
  db_wal:
    driver: local
  rabbitmq_data:
    driver: local
    driver_opts:
      type: none
      o: bind
      device: ${RABBITMQ_DATA_PATH:-./docker/rabbitmq/data}
  discovery-run:
    name: ${COMPOSE_PROJECT_NAME:-thatdamtoolbox}_discovery-run
  video-web-node_modules:
    driver: local
  video-web-next:
    driver: local
  video-web-npm:
    driver: local
  web-site-node_modules:
    driver: local
  web-site-next:
    driver: local
  web-site-npm:
    driver: local
